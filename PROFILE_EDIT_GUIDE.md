# Profile Edit - Setup Guide

## ุชู ุฅุถุงูุฉ ููุฒุฉ ุชุนุฏูู ุงูููู ุงูุดุฎุตู

### ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

#### 1. ุตูุญุฉ ุชุนุฏูู ุงูููู ุงูุดุฎุตู ([edit-profile.tsx](app/edit-profile.tsx))

- โ ุฑูุน/ุชุบููุฑ ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ
- โ ุชุนุฏูู ุงูุงุณู ุงููุงูู
- โ ุชุนุฏูู ุฑูู ุงููุงุชู
- โ ุฅูุดุงุก ูููุฉ ูุฑูุฑ ุฌุฏูุฏุฉ (ูููุณุชุฎุฏููู ูู Google)
- โ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ (ูููุณุชุฎุฏููู ุงูุนุงุฏููู)
- โ ุนุฑุถ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (ูููุฑุงุกุฉ ููุท)

#### 2. ูุธุงุฆู ุฌุฏูุฏุฉ ูู [services/auth.ts](services/auth.ts)

```typescript
// ุชุญุฏูุซ ุงูููู ุงูุดุฎุตู (ูุฏุนู avatar_url ุงูุขู)
updateProfile(updates: {
  full_name?: string;
  phone?: string | null;
  avatar_url?: string | null;
})

// ุชุญุฏูุซ ูููุฉ ุงููุฑูุฑ
updatePassword(newPassword: string)
```

#### 3. ุชุญุฏูุซุงุช ุตูุญุฉ ุงูููู ุงูุดุฎุตู ([profile.tsx](<app/(tabs)/profile.tsx>))

- โ ุนุฑุถ ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ ุฅุฐุง ูุงูุช ููุฌูุฏุฉ
- โ ุฅุถุงูุฉ ุฒุฑ "ุชุนุฏูู ุงูููู ุงูุดุฎุตู" ูุน ุงูุชููู ููุตูุญุฉ ุงูุฌุฏูุฏุฉ

---

## ุฅุนุฏุงุฏ Supabase Storage

### ุฅูุดุงุก Bucket ููุตูุฑ ุงูุดุฎุตูุฉ

1. ุงุฐูุจ ุฅูู [Supabase Dashboard](https://supabase.com/dashboard)
2. ุงุฎุชุฑ ูุดุฑูุนู
3. ุงุฐูุจ ุฅูู **Storage**
4. ุงููุฑ **New bucket**
5. ุงููุฃ ุงููุนูููุงุช:
   - **Name**: `avatars`
   - **Public bucket**: โ ูุนู (public)
   - **File size limit**: 1 MB
   - **Allowed MIME types**: `image/*`

### ุฅุนุฏุงุฏ ุงูุณูุงุณุงุช (RLS Policies)

ูู ุตูุญุฉ Storage > Policiesุ ุฃุถู ูุฐู ุงูุณูุงุณุงุช ูู `avatars`:

#### ุงูุณูุงุญ ุจุงููุฑุงุกุฉ ููุฌููุน (Public Read)

```sql
CREATE POLICY "Anyone can view avatars"
ON storage.objects FOR SELECT
USING (bucket_id = 'avatars');
```

#### ุงูุณูุงุญ ุจุงูุฑูุน ูููุณุชุฎุฏููู ุงููุตุงุฏููู (Upload for Authenticated Users)

```sql
CREATE POLICY "Authenticated users can upload avatars"
ON storage.objects FOR INSERT
WITH CHECK (
  bucket_id = 'avatars'
  AND auth.role() = 'authenticated'
);
```

#### ุงูุณูุงุญ ุจุงูุญุฐู (ุงููุณุชุฎุฏู ูุญุฐู ุตูุฑู ููุท)

```sql
CREATE POLICY "Users can delete own avatars"
ON storage.objects FOR DELETE
USING (
  bucket_id = 'avatars'
  AND auth.uid()::text = (storage.foldername(name))[1]
);
```

---

## ุงูุชุฑุฌูุงุช ุงูุฌุฏูุฏุฉ

ุชูุช ุฅุถุงูุฉ ุงูุชุฑุฌูุงุช ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ ูุงููุฑุฏูุฉ:

| Key                   | Arabic                      | English                      | Kurdish                              |
| --------------------- | --------------------------- | ---------------------------- | ------------------------------------ |
| `edit_profile`        | ุชุนุฏูู ุงูููู ุงูุดุฎุตู          | Edit Profile                 | ฺฏฺู ูพุฑูุงู                       |
| `change_password`     | ุชุบููุฑ ูููุฉ ุงููุฑูุฑ           | Change Password              | ฺฏฺู ูุด ููู                    |
| `create_password`     | ุฅูุดุงุก ูููุฉ ูุฑูุฑ             | Create Password              | ุฏุฑูุณุชฺฉุฑุฏู ูุด ููู                |
| `new_password`        | ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ         | New Password                 | ูุด ููู ูู                       |
| `confirm_password`    | ุชุฃููุฏ ูููุฉ ุงููุฑูุฑ           | Confirm Password             | ุฏฺตูุงฺฉุฑุฏูู ูุด ููู             |
| `passwords_not_match` | ูููุชุง ุงููุฑูุฑ ุบูุฑ ูุชุทุงุจูุชูู  | Passwords do not match       | ูุดฺฉุงู ููู ฺฉูุงฺฏุฑูู            |
| `tap_to_change_photo` | ุงุถุบุท ูุชุบููุฑ ุงูุตูุฑุฉ          | Tap to change photo          | ุฏุณุช ูุจุฏ ุจ ฺฏฺู ูู           |
| `profile_updated`     | ุชู ุชุญุฏูุซ ุงูููู ุงูุดุฎุตู ุจูุฌุงุญ | Profile updated successfully | ูพุฑูุงูฺฉ ุจ ุณุฑฺฉูุชูู ููฺฉุฑุงู |

---

## ุงุณุชุฎุฏุงู ุงูููุฒุฉ

### ุฅูุดุงุก ูููุฉ ูุฑูุฑ ููุณุชุฎุฏูู Google

1. ุงููุณุชุฎุฏู ุงูุฐู ุณุฌู ุฏุฎููู ุนุจุฑ Google ููุณ ูุฏูู ูููุฉ ูุฑูุฑ
2. ูู ุตูุญุฉ ุชุนุฏูู ุงูููู ุงูุดุฎุตูุ ูุฑู ูุณู "ุฅูุดุงุก ูููุฉ ูุฑูุฑ"
3. ูุฏุฎู ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ ููุคูุฏูุง
4. ุงูุขู ููููู ุชุณุฌูู ุงูุฏุฎูู ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุจุฏูุงู ูู Google

### ุชุบููุฑ ูููุฉ ุงููุฑูุฑ ูููุณุชุฎุฏููู ุงูุนุงุฏููู

1. ุงููุณุชุฎุฏู ุงูุฐู ูุฏูู ูููุฉ ูุฑูุฑ ุจุงููุนู ูุฑู ูุณู "ุชุบููุฑ ูููุฉ ุงููุฑูุฑ"
2. ูุฏุฎู ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ ููุคูุฏูุง
3. ูุชู ุชุญุฏูุซ ูููุฉ ุงููุฑูุฑ

### ุฑูุน ุตูุฑุฉ ุดุฎุตูุฉ

1. ุงุถุบุท ุนูู ุฏุงุฆุฑุฉ ุงูุตูุฑุฉ ูู ุฃุนูู ุงูุตูุญุฉ
2. ุงุฎุชุฑ ุตูุฑุฉ ูู ุงููุนุฑุถ
3. ูุชู ุฑูุน ุงูุตูุฑุฉ ุฅูู Supabase Storage (`avatars` bucket)
4. ูุชู ุชุญุฏูุซ `avatar_url` ูู ุงูููู ุงูุดุฎุตู
5. ุชุธูุฑ ุงูุตูุฑุฉ ูู ุตูุญุฉ ุงูููู ุงูุดุฎุตู ูุตูุญุฉ ุงูุชุนุฏูู

---

## ุงููููุงุช ุงููุนุฏูุฉ/ุงูููุดุฃุฉ

| File                     | ุงูุชุบููุฑ                                         |
| ------------------------ | ----------------------------------------------- |
| `app/edit-profile.tsx`   | โจ ุตูุญุฉ ุฌุฏูุฏุฉ - ุชุนุฏูู ุดุงูู ููููู ุงูุดุฎุตู         |
| `services/auth.ts`       | โ `updatePassword()` + ุชุญุฏูุซ `updateProfile()` |
| `app/(tabs)/profile.tsx` | ๐ ุฅุถุงูุฉ ุนุฑุถ ุงูุตูุฑุฉ + ุฒุฑ ุชุนุฏูู ุงูููู            |
| `i18n/ar.json`           | ๐ ุชุฑุฌูุงุช ุนุฑุจูุฉ ุฌุฏูุฏุฉ                           |
| `i18n/en.json`           | ๐ ุชุฑุฌูุงุช ุฅูุฌููุฒูุฉ ุฌุฏูุฏุฉ                        |
| `i18n/ku.json`           | ๐ ุชุฑุฌูุงุช ูุฑุฏูุฉ ุฌุฏูุฏุฉ                           |

---

## Security Notes

### ุฃูุงู ุงูุตูุฑ

- โ ุฑูุน ุงูุตูุฑ ูุชุทูุจ ูุตุงุฏูุฉ
- โ ุงูุตูุฑ ุนุงูุฉ (public) ููุนุฑุถ ููุท
- โ ุงููุณุชุฎุฏู ููููู ุญุฐู ุตูุฑู ููุท
- โ ุฃุณูุงุก ุงููููุงุช ุชุญุชูู ุนูู user ID + timestamp

### ุฃูุงู ูููุงุช ุงููุฑูุฑ

- โ ุชุณุชุฎุฏู Supabase Auth API ูุชุญุฏูุซ ูููุงุช ุงููุฑูุฑ
- โ ูุฌุจ ุฃู ุชููู 6 ุฃุญุฑู ุนูู ุงูุฃูู
- โ ุงูุชุฃููุฏ ูุทููุจ
- โ ุงุฎุชูุงุฑู (ูููู ุชุฑู ุงูุญูู ูุงุฑุบุงู)

---

## Next Steps

### ุงุฎุชุจุงุฑ ุงูููุฒุฉ

```bash
npx expo start
```

1. ุณุฌู ุฏุฎูู (ุนุงุฏู ุฃู Google)
2. ุงุฐูุจ ูุตูุญุฉ ุงูููู ุงูุดุฎุตู
3. ุงุถุบุท "ุชุนุฏูู ุงูููู ุงูุดุฎุตู"
4. ุฌุฑุจ ุฑูุน ุตูุฑุฉ
5. ุนุฏู ุงูุงุณู ูุงููุงุชู
6. ุฌุฑุจ ุฅูุดุงุก/ุชุบููุฑ ูููุฉ ุงููุฑูุฑ

### ุชุญุณููุงุช ูุณุชูุจููุฉ (ุงุฎุชูุงุฑูุฉ)

- [ ] ุถุบุท ุงูุตูุฑ ูุจู ุงูุฑูุน
- [ ] ุตูุบุฉ WebP ููุตูุฑ
- [ ] ูุต ุงูุตูุฑ (crop) ูุฎุตุต
- [ ] ุญุฐู ุงูุตูุฑุฉ ุงููุฏููุฉ ุนูุฏ ุฑูุน ุฌุฏูุฏุฉ
- [ ] ุชุฃููุฏ ูููุฉ ุงููุฑูุฑ ุงูุญุงููุฉ ูุจู ุชุบููุฑูุง
- [ ] ุชุบููุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู

---

โ **ุฌุงูุฒ ููุงุณุชุฎุฏุงู!**
